<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>su2hmc: production_c/force.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">su2hmc
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('force_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">force.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Code for force calculations.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="matrices_8h_source.html">matrices.h</a>&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for force.c:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="force_8c__incl.svg" width="787" height="626"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="force_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab8975ff11cde008308f4d18a8f25425e" id="r_ab8975ff11cde008308f4d18a8f25425e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ab8975ff11cde008308f4d18a8f25425e">Gauge_force</a> (double *dSdpi, <a class="el" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a> *ut[2], unsigned int *iu, unsigned int *id, float beta)</td></tr>
<tr class="memdesc:ab8975ff11cde008308f4d18a8f25425e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the gauge force due to the Wilson Action at each intermediate time.  <br /></td></tr>
<tr class="separator:ab8975ff11cde008308f4d18a8f25425e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98a5926c20124e0cea060ad1e47ff3de" id="r_a98a5926c20124e0cea060ad1e47ff3de"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a98a5926c20124e0cea060ad1e47ff3de">Force</a> (double *dSdpi, int iflag, double res1, <a class="el" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> *X0, <a class="el" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> *X1, <a class="el" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> *Phi, <a class="el" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> *ut[2], <a class="el" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a> *ut_f[2], unsigned int *iu, unsigned int *id, <a class="el" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> *gamval, <a class="el" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a> *gamval_f, int *gamin, double *dk[2], float *dk_f[2], <a class="el" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a> jqq, float akappa, float beta, double *ancg)</td></tr>
<tr class="memdesc:a98a5926c20124e0cea060ad1e47ff3de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the force \(\frac{dS}{d\pi}\) at each intermediate time.  <br /></td></tr>
<tr class="separator:a98a5926c20124e0cea060ad1e47ff3de"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Code for force calculations. </p>

<p class="definition">Definition in file <a class="el" href="force_8c_source.html">force.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a98a5926c20124e0cea060ad1e47ff3de" name="a98a5926c20124e0cea060ad1e47ff3de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98a5926c20124e0cea060ad1e47ff3de">&#9670;&#160;</a></span>Force()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Force </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>dSdpi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>iflag</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double</td>          <td class="paramname"><span class="paramname"><em>res1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> *</td>          <td class="paramname"><span class="paramname"><em>X0</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> *</td>          <td class="paramname"><span class="paramname"><em>X1</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> *</td>          <td class="paramname"><span class="paramname"><em>Phi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> *</td>          <td class="paramname"><span class="paramname"><em>ut</em></span>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a> *</td>          <td class="paramname"><span class="paramname"><em>ut_f</em></span>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>iu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> *</td>          <td class="paramname"><span class="paramname"><em>gamval</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a> *</td>          <td class="paramname"><span class="paramname"><em>gamval_f</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *</td>          <td class="paramname"><span class="paramname"><em>gamin</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>dk</em></span>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *</td>          <td class="paramname"><span class="paramname"><em>dk_f</em></span>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a></td>          <td class="paramname"><span class="paramname"><em>jqq</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>akappa</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>beta</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>ancg</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the force \(\frac{dS}{d\pi}\) at each intermediate time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dSdpi</td><td>The force </td></tr>
    <tr><td class="paramname">iflag</td><td>Invert before evaluating the force. 0 to invert, one not to. Blame FORTRAN... </td></tr>
    <tr><td class="paramname">res1</td><td>Conjugate gradient residule </td></tr>
    <tr><td class="paramname">X0</td><td>Up/down partitioned pseudofermion field </td></tr>
    <tr><td class="paramname">X1</td><td>Holder for the partitioned fermion field, then the conjugate gradient output </td></tr>
    <tr><td class="paramname">Phi</td><td>Pseudofermion field </td></tr>
    <tr><td class="paramname">ut</td><td>Double precision colour fields </td></tr>
    <tr><td class="paramname">u2t_f</td><td>Single precision colour fields </td></tr>
    <tr><td class="paramname">iu,id</td><td>Lattice indices </td></tr>
    <tr><td class="paramname">gamin</td><td>Gamma indices </td></tr>
    <tr><td class="paramname">gamval</td><td>Double precision gamma matrices rescaled by kappa </td></tr>
    <tr><td class="paramname">gamval_f</td><td>Single precision gamma matrices rescaled by kappa </td></tr>
    <tr><td class="paramname">dk</td><td>\(e^{-\mu}\) and \(e^\mu\) </td></tr>
    <tr><td class="paramname">dk_f</td><td>\(e^{-\mu}\) and \(e^\mu\) float </td></tr>
    <tr><td class="paramname">jqq</td><td>Diquark source </td></tr>
    <tr><td class="paramname">akappa</td><td>Hopping parameter </td></tr>
    <tr><td class="paramname">beta</td><td>Inverse gauge coupling </td></tr>
    <tr><td class="paramname">ancg</td><td>Counter for conjugate gradient iterations</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero on success, integer error code otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="force_8c_source.html#l00094">94</a> of file <a class="el" href="force_8c_source.html">force.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   96</span>                                                                                                  {</div>
<div class="line"><span class="lineno">   97</span>   <span class="comment">/*</span></div>
<div class="line"><span class="lineno">   98</span><span class="comment">    * @brief Calculates the force @f$\frac{dS}{d\pi}@f$ at each intermediate time</span></div>
<div class="line"><span class="lineno">   99</span><span class="comment">    * </span></div>
<div class="line"><span class="lineno">  100</span><span class="comment">    * @param   dSdpi:         The force</span></div>
<div class="line"><span class="lineno">  101</span><span class="comment">    * @param   iflag:         Invert before evaluating the force? </span></div>
<div class="line"><span class="lineno">  102</span><span class="comment">    * @param   res1:          Conjugate gradient residule</span></div>
<div class="line"><span class="lineno">  103</span><span class="comment">    * @param   X0:            Up/down partitioned pseudofermion field</span></div>
<div class="line"><span class="lineno">  104</span><span class="comment">    * @param   X1:            Holder for the partitioned fermion field, then the conjugate gradient output</span></div>
<div class="line"><span class="lineno">  105</span><span class="comment">    * @param   Phi:           Pseudofermion field</span></div>
<div class="line"><span class="lineno">  106</span><span class="comment">    * @param   ut[0],ut[1]    Double precision colour fields</span></div>
<div class="line"><span class="lineno">  107</span><span class="comment">    * @param   ut_f[0],ut_f[1]:  Single precision colour fields</span></div>
<div class="line"><span class="lineno">  108</span><span class="comment">    * @param   iu,id:         Lattice indices</span></div>
<div class="line"><span class="lineno">  109</span><span class="comment">    * @param   gamin:         Gamma indices</span></div>
<div class="line"><span class="lineno">  110</span><span class="comment">    * @param   gamval:        Double precision gamma matrices</span></div>
<div class="line"><span class="lineno">  111</span><span class="comment">    * @param   gamval_f:      Single precision gamma matrices</span></div>
<div class="line"><span class="lineno">  112</span><span class="comment">    * @param   dk[0]:            @f$\left(1+\gamma_0\right)e^{-\mu}@f$</span></div>
<div class="line"><span class="lineno">  113</span><span class="comment">    * @param   dk[1]:            @f$\left(1-\gamma_0\right)e^\mu@f$</span></div>
<div class="line"><span class="lineno">  114</span><span class="comment">    * @param   dk_f[0]:       @f$\left(1+\gamma_0\right)e^{-\mu}@f$ float</span></div>
<div class="line"><span class="lineno">  115</span><span class="comment">    * @param   dk_f[1]:       @f$\left(1-\gamma_0\right)e^\mu@f$ float</span></div>
<div class="line"><span class="lineno">  116</span><span class="comment">    * @param   jqq:           Diquark source</span></div>
<div class="line"><span class="lineno">  117</span><span class="comment">    * @param   akappa:        Hopping parameter</span></div>
<div class="line"><span class="lineno">  118</span><span class="comment">    * @param   beta:          Inverse gauge coupling</span></div>
<div class="line"><span class="lineno">  119</span><span class="comment">    * @param   ancg:          Counter for conjugate gradient iterations</span></div>
<div class="line"><span class="lineno">  120</span><span class="comment">    *</span></div>
<div class="line"><span class="lineno">  121</span><span class="comment">    * @return Zero on success, integer error code otherwise</span></div>
<div class="line"><span class="lineno">  122</span><span class="comment">    */</span></div>
<div class="line"><span class="lineno">  123</span>   <span class="keyword">const</span> <span class="keywordtype">char</span> *funcname = <span class="stringliteral">&quot;Force&quot;</span>;</div>
<div class="line"><span class="lineno">  124</span><span class="preprocessor">#ifdef __NVCC__</span></div>
<div class="line"><span class="lineno">  125</span>   <span class="keywordtype">int</span> device=-1;</div>
<div class="line"><span class="lineno">  126</span>   cudaGetDevice(&amp;device);</div>
<div class="line"><span class="lineno">  127</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  128</span><span class="preprocessor">#ifndef NO_GAUGE</span></div>
<div class="line"><span class="lineno">  129</span>   <a class="code hl_function" href="#ab8975ff11cde008308f4d18a8f25425e">Gauge_force</a>(dSdpi,ut_f,iu,<span class="keywordtype">id</span>,beta);</div>
<div class="line"><span class="lineno">  130</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  131</span>   <span class="keywordflow">if</span>(!akappa)</div>
<div class="line"><span class="lineno">  132</span>      <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  133</span>   <span class="comment">//X1=(M†M)^{1} Phi</span></div>
<div class="line"><span class="lineno">  134</span>   <span class="keywordtype">int</span> itercg=1;</div>
<div class="line"><span class="lineno">  135</span><span class="preprocessor">#ifdef __NVCC__</span></div>
<div class="line"><span class="lineno">  136</span>   <a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a> *X1_f, *X2_f;</div>
<div class="line"><span class="lineno">  137</span>   cudaMallocAsync((<span class="keywordtype">void</span> **)&amp;X2_f,<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>*<span class="keyword">sizeof</span>(<a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a>),streams[0]);</div>
<div class="line"><span class="lineno">  138</span>   cudaMallocAsync((<span class="keywordtype">void</span> **)&amp;X1_f,<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>*<span class="keyword">sizeof</span>(<a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a>),NULL);</div>
<div class="line"><span class="lineno">  139</span>   cuComplex_convert(X1_f,X1,<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>,<span class="keyword">true</span>,dimBlock,dimGrid);</div>
<div class="line"><span class="lineno">  140</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  141</span>   <a class="code hl_define" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> *X2= (<a class="code hl_define" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> *)aligned_alloc(<a class="code hl_define" href="sizes_8h.html#a0235e95ffa2570e0d229e23f65855719">AVX</a>,<a class="code hl_define" href="sizes_8h.html#a36126fb9c56da5fb6713943ca7ea3264">kferm2Halo</a>*<span class="keyword">sizeof</span>(<a class="code hl_define" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a>));</div>
<div class="line"><span class="lineno">  142</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  143</span>   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> na = 0; na&lt;<a class="code hl_define" href="sizes_8h.html#a96392c5c7e198251a7efacba03414393">nf</a>; na++){</div>
<div class="line"><span class="lineno">  144</span><span class="preprocessor">#ifdef __NVCC__</span></div>
<div class="line"><span class="lineno">  145</span>      cudaMemcpyAsync(X1,X0+na*<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>,<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>*<span class="keyword">sizeof</span>(<a class="code hl_define" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a>),cudaMemcpyDeviceToDevice,NULL);</div>
<div class="line"><span class="lineno">  146</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  147</span>      memcpy(X1,X0+na*<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>,<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>*<span class="keyword">sizeof</span>(<a class="code hl_define" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a>));</div>
<div class="line"><span class="lineno">  148</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  149</span>      <span class="keywordflow">if</span>(!iflag){</div>
<div class="line"><span class="lineno">  150</span><span class="preprocessor">#ifdef __NVCC__</span></div>
<div class="line"><span class="lineno">  151</span>         <a class="code hl_define" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> *smallPhi;</div>
<div class="line"><span class="lineno">  152</span>         cudaMallocAsync((<span class="keywordtype">void</span> **)&amp;smallPhi,<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>*<span class="keyword">sizeof</span>(<a class="code hl_define" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a>),streams[0]);</div>
<div class="line"><span class="lineno">  153</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  154</span>         <a class="code hl_define" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> *smallPhi = (<a class="code hl_define" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> *)aligned_alloc(<a class="code hl_define" href="sizes_8h.html#a0235e95ffa2570e0d229e23f65855719">AVX</a>,<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>*<span class="keyword">sizeof</span>(<a class="code hl_define" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a>)); </div>
<div class="line"><span class="lineno">  155</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  156</span>         <a class="code hl_function" href="su2hmc_8h.html#ad4816b4c3599a65d212f34e10c83055f">Fill_Small_Phi</a>(na, smallPhi, Phi);</div>
<div class="line"><span class="lineno">  157</span>         <span class="comment">// Congradq(na, res1,smallPhi, &amp;itercg );</span></div>
<div class="line"><span class="lineno">  158</span>         <a class="code hl_function" href="su2hmc_8h.html#a4b97a088fd74bb3b25ce4f965dc26281">Congradq</a>(na,res1,X1,smallPhi,ut_f,iu,<span class="keywordtype">id</span>,gamval_f,gamin,dk_f,jqq,akappa,&amp;itercg);</div>
<div class="line"><span class="lineno">  159</span><span class="preprocessor">#ifdef __NVCC__</span></div>
<div class="line"><span class="lineno">  160</span>         cudaFreeAsync(smallPhi,streams[0]);</div>
<div class="line"><span class="lineno">  161</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  162</span>         free(smallPhi);</div>
<div class="line"><span class="lineno">  163</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  164</span>         *ancg+=itercg;</div>
<div class="line"><span class="lineno">  165</span><span class="preprocessor">#ifdef __NVCC__</span></div>
<div class="line"><span class="lineno">  166</span>         <a class="code hl_define" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> blasa=2.0; <span class="keywordtype">double</span> blasb=-1.0;</div>
<div class="line"><span class="lineno">  167</span>         cublasZdscal(cublas_handle,<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>,&amp;blasb,(cuDoubleComplex *)(X0+na*<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>),1);</div>
<div class="line"><span class="lineno">  168</span>         cublasZaxpy(cublas_handle,<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>,(cuDoubleComplex *)&amp;blasa,(cuDoubleComplex *)X1,1,(cuDoubleComplex *)(X0+na*<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>),1);</div>
<div class="line"><span class="lineno">  169</span>         cuComplex_convert(X1_f,X1,<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>,<span class="keyword">true</span>,dimBlock,dimGrid);</div>
<div class="line"><span class="lineno">  170</span>         <span class="comment">//HDslash launches a different stream so we need a barrieer</span></div>
<div class="line"><span class="lineno">  171</span>         cudaDeviceSynchronise();</div>
<div class="line"><span class="lineno">  172</span><span class="preprocessor">#elif (defined __INTEL_MKL__)</span></div>
<div class="line"><span class="lineno">  173</span>         <a class="code hl_define" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> blasa=2.0; <a class="code hl_define" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> blasb=-1.0;</div>
<div class="line"><span class="lineno">  174</span>         <span class="comment">//This is not a general BLAS Routine. BLIS and MKl support it</span></div>
<div class="line"><span class="lineno">  175</span>         <span class="comment">//CUDA and GSL does not support it</span></div>
<div class="line"><span class="lineno">  176</span>         cblas_zaxpby(<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>, &amp;blasa, X1, 1, &amp;blasb, X0+na*<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>, 1); </div>
<div class="line"><span class="lineno">  177</span><span class="preprocessor">#elif defined USE_BLAS</span></div>
<div class="line"><span class="lineno">  178</span>         <a class="code hl_define" href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a> blasa=2.0; <span class="keywordtype">double</span> blasb=-1.0;</div>
<div class="line"><span class="lineno">  179</span>         cblas_zdscal(<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>,blasb,X0+na*<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>,1);</div>
<div class="line"><span class="lineno">  180</span>         cblas_zaxpy(<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>,&amp;blasa,X1,1,X0+na*<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>,1);</div>
<div class="line"><span class="lineno">  181</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  182</span><span class="preprocessor">#pragma omp parallel for simd collapse(2)</span></div>
<div class="line"><span class="lineno">  183</span>         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_define" href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a>;i++)</div>
<div class="line"><span class="lineno">  184</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> idirac=0;idirac&lt;<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>;idirac++){</div>
<div class="line"><span class="lineno">  185</span>               X0[((na*<a class="code hl_define" href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a>+i)*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]=</div>
<div class="line"><span class="lineno">  186</span>                  2*X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]-X0[((na*<a class="code hl_define" href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a>+i)*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>];</div>
<div class="line"><span class="lineno">  187</span>               X0[((na*<a class="code hl_define" href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a>+i)*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]=</div>
<div class="line"><span class="lineno">  188</span>                  2*X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]-X0[((na*<a class="code hl_define" href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a>+i)*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1];</div>
<div class="line"><span class="lineno">  189</span>            }</div>
<div class="line"><span class="lineno">  190</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  191</span>      }</div>
<div class="line"><span class="lineno">  192</span><span class="preprocessor">      #ifdef __NVCC__</span></div>
<div class="line"><span class="lineno">  193</span>      <a class="code hl_function" href="matrices_8h.html#a68e018d0a9d3c7ae5e175f87da75d881">Hdslash_f</a>(X2_f,X1_f,ut_f,iu,<span class="keywordtype">id</span>,gamval_f,gamin,dk_f,akappa);</div>
<div class="line"><span class="lineno">  194</span><span class="preprocessor">      #else</span></div>
<div class="line"><span class="lineno">  195</span>      <a class="code hl_function" href="matrices_8h.html#aa455f004090044b721b079277a91a753">Hdslash</a>(X2,X1,ut,iu,<span class="keywordtype">id</span>,gamval,gamin,dk,akappa);</div>
<div class="line"><span class="lineno">  196</span><span class="preprocessor">      #endif</span></div>
<div class="line"><span class="lineno">  197</span><span class="preprocessor">#ifdef __NVCC__</span></div>
<div class="line"><span class="lineno">  198</span>      <span class="keywordtype">float</span> blasd=2.0;</div>
<div class="line"><span class="lineno">  199</span>      cudaDeviceSynchronise();</div>
<div class="line"><span class="lineno">  200</span>      cublasCsscal(cublas_handle,<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>, &amp;blasd, (cuComplex *)X2_f, 1);</div>
<div class="line"><span class="lineno">  201</span><span class="preprocessor">#elif defined USE_BLAS</span></div>
<div class="line"><span class="lineno">  202</span>      <span class="keywordtype">double</span> blasd=2.0;</div>
<div class="line"><span class="lineno">  203</span>      cblas_zdscal(<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>, blasd, X2, 1);</div>
<div class="line"><span class="lineno">  204</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  205</span><span class="preprocessor">#pragma unroll</span></div>
<div class="line"><span class="lineno">  206</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_define" href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a>;i++)</div>
<div class="line"><span class="lineno">  207</span>         X2[i]*=2;</div>
<div class="line"><span class="lineno">  208</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  209</span><span class="preprocessor">#if(npx&gt;1)</span></div>
<div class="line"><span class="lineno">  210</span>      <a class="code hl_function" href="par__mpi_8h.html#a893a7c85fb77e355d4cec6bc35711b98">ZHalo_swap_dir</a>(X1,8,0,<a class="code hl_define" href="par__mpi_8h.html#a4193cd1c8c2e6ebd0e056fa2364a663f">DOWN</a>);</div>
<div class="line"><span class="lineno">  211</span>      <a class="code hl_function" href="par__mpi_8h.html#a893a7c85fb77e355d4cec6bc35711b98">ZHalo_swap_dir</a>(X2,8,0,<a class="code hl_define" href="par__mpi_8h.html#a4193cd1c8c2e6ebd0e056fa2364a663f">DOWN</a>);</div>
<div class="line"><span class="lineno">  212</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  213</span><span class="preprocessor">#if(npy&gt;1)</span></div>
<div class="line"><span class="lineno">  214</span>      <a class="code hl_function" href="par__mpi_8h.html#a893a7c85fb77e355d4cec6bc35711b98">ZHalo_swap_dir</a>(X1,8,1,<a class="code hl_define" href="par__mpi_8h.html#a4193cd1c8c2e6ebd0e056fa2364a663f">DOWN</a>);</div>
<div class="line"><span class="lineno">  215</span>      <a class="code hl_function" href="par__mpi_8h.html#a893a7c85fb77e355d4cec6bc35711b98">ZHalo_swap_dir</a>(X2,8,1,<a class="code hl_define" href="par__mpi_8h.html#a4193cd1c8c2e6ebd0e056fa2364a663f">DOWN</a>);</div>
<div class="line"><span class="lineno">  216</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  217</span><span class="preprocessor">#if(npz&gt;1)</span></div>
<div class="line"><span class="lineno">  218</span>      <a class="code hl_function" href="par__mpi_8h.html#a893a7c85fb77e355d4cec6bc35711b98">ZHalo_swap_dir</a>(X1,8,2,<a class="code hl_define" href="par__mpi_8h.html#a4193cd1c8c2e6ebd0e056fa2364a663f">DOWN</a>);</div>
<div class="line"><span class="lineno">  219</span>      <a class="code hl_function" href="par__mpi_8h.html#a893a7c85fb77e355d4cec6bc35711b98">ZHalo_swap_dir</a>(X2,8,2,<a class="code hl_define" href="par__mpi_8h.html#a4193cd1c8c2e6ebd0e056fa2364a663f">DOWN</a>);</div>
<div class="line"><span class="lineno">  220</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  221</span><span class="preprocessor">#if(npt&gt;1)</span></div>
<div class="line"><span class="lineno">  222</span>      <a class="code hl_function" href="par__mpi_8h.html#a893a7c85fb77e355d4cec6bc35711b98">ZHalo_swap_dir</a>(X1,8,3,<a class="code hl_define" href="par__mpi_8h.html#a4193cd1c8c2e6ebd0e056fa2364a663f">DOWN</a>);</div>
<div class="line"><span class="lineno">  223</span>      <a class="code hl_function" href="par__mpi_8h.html#a893a7c85fb77e355d4cec6bc35711b98">ZHalo_swap_dir</a>(X2,8,3,<a class="code hl_define" href="par__mpi_8h.html#a4193cd1c8c2e6ebd0e056fa2364a663f">DOWN</a>);</div>
<div class="line"><span class="lineno">  224</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>      <span class="comment">// The original FORTRAN Comment:</span></div>
<div class="line"><span class="lineno">  227</span>      <span class="comment">//    dSdpi=dSdpi-Re(X1*(d(Mdagger)dp)*X2) -- Yikes!</span></div>
<div class="line"><span class="lineno">  228</span>      <span class="comment">//   we&#39;re gonna need drugs for this one......</span></div>
<div class="line"><span class="lineno">  229</span>      <span class="comment">//</span></div>
<div class="line"><span class="lineno">  230</span>      <span class="comment">//  Makes references to X1(.,.,iu(i,mu)) AND X2(.,.,iu(i,mu))</span></div>
<div class="line"><span class="lineno">  231</span>      <span class="comment">//  as a result, need to swap the DOWN halos in all dirs for</span></div>
<div class="line"><span class="lineno">  232</span>      <span class="comment">//  both these arrays, each of which has 8 cpts</span></div>
<div class="line"><span class="lineno">  233</span>      <span class="comment">//</span></div>
<div class="line"><span class="lineno">  234</span><span class="preprocessor">#ifdef __NVCC__</span></div>
<div class="line"><span class="lineno">  235</span>      cuForce(dSdpi,ut_f,X1_f,X2_f,gamval_f,dk_f,iu,gamin,akappa,dimGrid,dimBlock);</div>
<div class="line"><span class="lineno">  236</span>      cudaDeviceSynchronise();</div>
<div class="line"><span class="lineno">  237</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  238</span><span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><span class="lineno">  239</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_define" href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a>;i++)</div>
<div class="line"><span class="lineno">  240</span>         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> idirac=0;idirac&lt;<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>;idirac++){</div>
<div class="line"><span class="lineno">  241</span>            <span class="keywordtype">int</span> mu, uid, igork1;</div>
<div class="line"><span class="lineno">  242</span><span class="preprocessor">#ifndef NO_SPACE</span></div>
<div class="line"><span class="lineno">  243</span><span class="preprocessor">#pragma omp simd </span><span class="comment">//aligned(dSdpi,X1,X2,ut[0],ut[1],iu:AVX)</span></div>
<div class="line"><span class="lineno">  244</span>            <span class="keywordflow">for</span>(mu=0; mu&lt;3; mu++){</div>
<div class="line"><span class="lineno">  245</span>               <span class="comment">//Long term ambition. I used the diff command on the different</span></div>
<div class="line"><span class="lineno">  246</span>               <span class="comment">//spacial components of dSdpi and saw a lot of the values required</span></div>
<div class="line"><span class="lineno">  247</span>               <span class="comment">//for them are duplicates (u11(i,mu)*X2(1,idirac,i) is used again with</span></div>
<div class="line"><span class="lineno">  248</span>               <span class="comment">//a minus in front for example. Why not evaluate them first /and then plug </span></div>
<div class="line"><span class="lineno">  249</span>               <span class="comment">//them into the equation? Reduce the number of evaluations needed and look</span></div>
<div class="line"><span class="lineno">  250</span>               <span class="comment">//a bit neater (although harder to follow as a consequence).</span></div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>               <span class="comment">//Up indices</span></div>
<div class="line"><span class="lineno">  253</span>               uid = iu[mu+<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>*i];</div>
<div class="line"><span class="lineno">  254</span>               igork1 = gamin[mu*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac];   </div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>               <span class="comment">//REMINDER. Gamma is already scaled by kappa when we defined them. So if yer trying to rederive this from</span></div>
<div class="line"><span class="lineno">  257</span>               <span class="comment">//Montvay and Munster and notice a missing kappa in the code, that is why.</span></div>
<div class="line"><span class="lineno">  258</span>               dSdpi[(i*<a class="code hl_define" href="sizes_8h.html#a55cdab879029c36c07fbd9e7e9b109c9">nadj</a>)*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]+=akappa*creal(I*</div>
<div class="line"><span class="lineno">  259</span>                     (conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  260</span>                      (-conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  261</span>                       +conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  262</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  263</span>                      ( ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  264</span>                        -conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  265</span>                      +conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  266</span>                      (ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  267</span>                       +ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  268</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  269</span>                      (-ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  270</span>                       -conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])));</div>
<div class="line"><span class="lineno">  271</span>               dSdpi[(i*<a class="code hl_define" href="sizes_8h.html#a55cdab879029c36c07fbd9e7e9b109c9">nadj</a>)*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]+=creal(I*gamval[mu*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac]*</div>
<div class="line"><span class="lineno">  272</span>                     (conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  273</span>                      (-conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  274</span>                       +conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  275</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  276</span>                      (-ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  277</span>                       +conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  278</span>                      +conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  279</span>                      (ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  280</span>                       +ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  281</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  282</span>                      (ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  283</span>                       +conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])));</div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span>               dSdpi[(i*<a class="code hl_define" href="sizes_8h.html#a55cdab879029c36c07fbd9e7e9b109c9">nadj</a>+1)*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]+=akappa*creal(</div>
<div class="line"><span class="lineno">  286</span>                     (conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  287</span>                      (-conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  288</span>                       +conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  289</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  290</span>                      (-ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  291</span>                       -conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  292</span>                      +conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  293</span>                      (-ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  294</span>                       -ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  295</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  296</span>                      (ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  297</span>                       -conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])));</div>
<div class="line"><span class="lineno">  298</span>               dSdpi[(i*<a class="code hl_define" href="sizes_8h.html#a55cdab879029c36c07fbd9e7e9b109c9">nadj</a>+1)*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]+=creal(gamval[mu*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac]*</div>
<div class="line"><span class="lineno">  299</span>                     (conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  300</span>                      (-conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  301</span>                       +conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  302</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  303</span>                      (ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  304</span>                       +conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  305</span>                      +conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  306</span>                      (-ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  307</span>                       -ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  308</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  309</span>                      (-ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  310</span>                       +conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])));</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>               dSdpi[(i*<a class="code hl_define" href="sizes_8h.html#a55cdab879029c36c07fbd9e7e9b109c9">nadj</a>+2)*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]+=akappa*creal(I*</div>
<div class="line"><span class="lineno">  313</span>                     (conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  314</span>                      (ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  315</span>                       +ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  316</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  317</span>                      (-conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  318</span>                       -ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  319</span>                      +conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  320</span>                      (conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  321</span>                       -conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  322</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  323</span>                      (-conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  324</span>                       +ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])));</div>
<div class="line"><span class="lineno">  325</span>               dSdpi[(i*<a class="code hl_define" href="sizes_8h.html#a55cdab879029c36c07fbd9e7e9b109c9">nadj</a>+2)*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]+=creal(I*gamval[mu*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac]*</div>
<div class="line"><span class="lineno">  326</span>                     (conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  327</span>                      (ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  328</span>                       +ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  329</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  330</span>                      (conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  331</span>                       +ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  332</span>                      +conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  333</span>                      (conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  334</span>                       -conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])</div>
<div class="line"><span class="lineno">  335</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  336</span>                      (conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  337</span>                       -ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])));</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>            }</div>
<div class="line"><span class="lineno">  340</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  341</span>            <span class="comment">//We&#39;re not done tripping yet!! Time like term is different. dk4? shows up</span></div>
<div class="line"><span class="lineno">  342</span>            <span class="comment">//For consistency we&#39;ll leave mu in instead of hard coding.</span></div>
<div class="line"><span class="lineno">  343</span>            mu=3;</div>
<div class="line"><span class="lineno">  344</span>            uid = iu[mu+<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>*i];</div>
<div class="line"><span class="lineno">  345</span>            igork1 = gamin[mu*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac];   </div>
<div class="line"><span class="lineno">  346</span><span class="preprocessor">#ifndef NO_TIME</span></div>
<div class="line"><span class="lineno">  347</span>            dSdpi[(i*<a class="code hl_define" href="sizes_8h.html#a55cdab879029c36c07fbd9e7e9b109c9">nadj</a>)*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]+=creal(I*</div>
<div class="line"><span class="lineno">  348</span>                  (conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  349</span>                   (dk[0][i]*(-conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  350</span>                              +conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  351</span>                   +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  352</span>                   (dk[1][i]*      (+ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  353</span>                                    -conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  354</span>                   +conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  355</span>                   (dk[0][i]*       (ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  356</span>                                     +ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  357</span>                   +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  358</span>                   (dk[1][i]*      (-ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  359</span>                                    -conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))))</div>
<div class="line"><span class="lineno">  360</span>               +creal(I*</div>
<div class="line"><span class="lineno">  361</span>                     (conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  362</span>                      (dk[0][i]*(-conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  363</span>                                 +conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  364</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  365</span>                      (-dk[1][i]*       (ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  366</span>                                         -conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  367</span>                      +conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  368</span>                      (dk[0][i]*       (ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  369</span>                                        +ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  370</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  371</span>                      (-dk[1][i]*      (-ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  372</span>                                        -conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))));</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>            dSdpi[(i*<a class="code hl_define" href="sizes_8h.html#a55cdab879029c36c07fbd9e7e9b109c9">nadj</a>+1)*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]+=creal(</div>
<div class="line"><span class="lineno">  375</span>                  conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  376</span>                  (dk[0][i]*(-conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  377</span>                             +conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  378</span>                  +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  379</span>                  (dk[1][i]*      (-ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  380</span>                                   -conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  381</span>                  +conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  382</span>                  (dk[0][i]*      (-ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  383</span>                                   -ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  384</span>                  +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  385</span>                  (dk[1][i]*      ( ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  386</span>                                    -conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])))</div>
<div class="line"><span class="lineno">  387</span>               +creal(</div>
<div class="line"><span class="lineno">  388</span>                     (conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  389</span>                      (dk[0][i]*(-conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  390</span>                                 +conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  391</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  392</span>                      (-dk[1][i]*      (-ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  393</span>                                        -conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  394</span>                      +conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  395</span>                      (dk[0][i]*      (-ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  396</span>                                       -ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  397</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  398</span>                      (-dk[1][i]*       (ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  399</span>                                         -conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))));</div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>            dSdpi[(i*<a class="code hl_define" href="sizes_8h.html#a55cdab879029c36c07fbd9e7e9b109c9">nadj</a>+2)*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]+=creal(I*</div>
<div class="line"><span class="lineno">  402</span>                  (conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  403</span>                   (dk[0][i]*       (ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  404</span>                                     +ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  405</span>                   +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  406</span>                   (dk[1][i]*(-conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  407</span>                              -ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  408</span>                   +conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  409</span>                   (dk[0][i]* (conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  410</span>                               -conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  411</span>                   +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  412</span>                   (dk[1][i]*(-conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  413</span>                              +ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))))</div>
<div class="line"><span class="lineno">  414</span>               +creal(I*</div>
<div class="line"><span class="lineno">  415</span>                     (conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  416</span>                      (dk[0][i]*       (ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  417</span>                                        +ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  418</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>])*</div>
<div class="line"><span class="lineno">  419</span>                      (-dk[1][i]*(-conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  420</span>                                  -ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  421</span>                      +conj(X1[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  422</span>                      (dk[0][i]* (conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  423</span>                                  -conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))</div>
<div class="line"><span class="lineno">  424</span>                      +conj(X1[(uid*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+idirac)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1])*</div>
<div class="line"><span class="lineno">  425</span>                      (-dk[1][i]*(-conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>]</div>
<div class="line"><span class="lineno">  426</span>                                  +ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu] *X2[(i*<a class="code hl_define" href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a>+igork1)*<a class="code hl_define" href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a>+1]))));</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  429</span>         }</div>
<div class="line"><span class="lineno">  430</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  431</span>   }</div>
<div class="line"><span class="lineno">  432</span><span class="preprocessor">#ifdef __NVCC__</span></div>
<div class="line"><span class="lineno">  433</span>   cudaFreeAsync(X1_f,streams[0]); cudaFreeAsync(X2_f,streams[1]);</div>
<div class="line"><span class="lineno">  434</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  435</span>   free(X2); </div>
<div class="line"><span class="lineno">  436</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  437</span>   <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  438</span>}</div>
<div class="ttc" id="aforce_8c_html_ab8975ff11cde008308f4d18a8f25425e"><div class="ttname"><a href="#ab8975ff11cde008308f4d18a8f25425e">Gauge_force</a></div><div class="ttdeci">int Gauge_force(double *dSdpi, Complex_f *ut[2], unsigned int *iu, unsigned int *id, float beta)</div><div class="ttdoc">Calculates the gauge force due to the Wilson Action at each intermediate time.</div><div class="ttdef"><b>Definition</b> <a href="force_8c_source.html#l00006">force.c:6</a></div></div>
<div class="ttc" id="amatrices_8h_html_a68e018d0a9d3c7ae5e175f87da75d881"><div class="ttname"><a href="matrices_8h.html#a68e018d0a9d3c7ae5e175f87da75d881">Hdslash_f</a></div><div class="ttdeci">int Hdslash_f(Complex_f *phi, Complex_f *r, Complex_f *ut[2], unsigned int *iu, unsigned int *id, Complex_f *gamval, int *gamin, float *dk[2], float akappa)</div><div class="ttdoc">Evaluates  in single precision.</div><div class="ttdef"><b>Definition</b> <a href="matrices_8c_source.html#l00712">matrices.c:712</a></div></div>
<div class="ttc" id="amatrices_8h_html_aa455f004090044b721b079277a91a753"><div class="ttname"><a href="matrices_8h.html#aa455f004090044b721b079277a91a753">Hdslash</a></div><div class="ttdeci">int Hdslash(Complex *phi, Complex *r, Complex *u11t[2], unsigned int *iu, unsigned int *id, Complex *gamval, int *gamin, double *dk[2], float akappa)</div><div class="ttdoc">Evaluates  in double precision.</div><div class="ttdef"><b>Definition</b> <a href="matrices_8c_source.html#l00268">matrices.c:268</a></div></div>
<div class="ttc" id="apar__mpi_8h_html_a4193cd1c8c2e6ebd0e056fa2364a663f"><div class="ttname"><a href="par__mpi_8h.html#a4193cd1c8c2e6ebd0e056fa2364a663f">DOWN</a></div><div class="ttdeci">#define DOWN</div><div class="ttdoc">Flag for send down.</div><div class="ttdef"><b>Definition</b> <a href="par__mpi_8h_source.html#l00035">par_mpi.h:35</a></div></div>
<div class="ttc" id="apar__mpi_8h_html_a893a7c85fb77e355d4cec6bc35711b98"><div class="ttname"><a href="par__mpi_8h.html#a893a7c85fb77e355d4cec6bc35711b98">ZHalo_swap_dir</a></div><div class="ttdeci">int ZHalo_swap_dir(Complex *z, int ncpt, int idir, int layer)</div><div class="ttdoc">Swaps the halos along the axis given by idir in the direction given by layer.</div></div>
<div class="ttc" id="asizes_8h_html_a0235e95ffa2570e0d229e23f65855719"><div class="ttname"><a href="sizes_8h.html#a0235e95ffa2570e0d229e23f65855719">AVX</a></div><div class="ttdeci">#define AVX</div><div class="ttdoc">Alignment of arrays. 64 for AVX-512, 32 for AVX/AVX2. 16 for SSE. Since AVX is standard on modern x86...</div><div class="ttdef"><b>Definition</b> <a href="sizes_8h_source.html#l00268">sizes.h:268</a></div></div>
<div class="ttc" id="asizes_8h_html_a0845b4b004824f1fe3cd69db1672fa15"><div class="ttname"><a href="sizes_8h.html#a0845b4b004824f1fe3cd69db1672fa15">nc</a></div><div class="ttdeci">#define nc</div><div class="ttdoc">Colours.</div><div class="ttdef"><b>Definition</b> <a href="sizes_8h_source.html#l00173">sizes.h:173</a></div></div>
<div class="ttc" id="asizes_8h_html_a36126fb9c56da5fb6713943ca7ea3264"><div class="ttname"><a href="sizes_8h.html#a36126fb9c56da5fb6713943ca7ea3264">kferm2Halo</a></div><div class="ttdeci">#define kferm2Halo</div><div class="ttdoc">Dirac lattice and halo.</div><div class="ttdef"><b>Definition</b> <a href="sizes_8h_source.html#l00227">sizes.h:227</a></div></div>
<div class="ttc" id="asizes_8h_html_a55cdab879029c36c07fbd9e7e9b109c9"><div class="ttname"><a href="sizes_8h.html#a55cdab879029c36c07fbd9e7e9b109c9">nadj</a></div><div class="ttdeci">#define nadj</div><div class="ttdoc">adjacent spatial indices</div><div class="ttdef"><b>Definition</b> <a href="sizes_8h_source.html#l00175">sizes.h:175</a></div></div>
<div class="ttc" id="asizes_8h_html_a5a091d04c7929c6484096936e72def64"><div class="ttname"><a href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a></div><div class="ttdeci">#define kvol</div><div class="ttdoc">Sublattice volume.</div><div class="ttdef"><b>Definition</b> <a href="sizes_8h_source.html#l00154">sizes.h:154</a></div></div>
<div class="ttc" id="asizes_8h_html_a6ad4b075e3dabd5d5215f7eabbc98e08"><div class="ttname"><a href="sizes_8h.html#a6ad4b075e3dabd5d5215f7eabbc98e08">Complex</a></div><div class="ttdeci">#define Complex</div><div class="ttdoc">Double precision complex number.</div><div class="ttdef"><b>Definition</b> <a href="sizes_8h_source.html#l00058">sizes.h:58</a></div></div>
<div class="ttc" id="asizes_8h_html_a96392c5c7e198251a7efacba03414393"><div class="ttname"><a href="sizes_8h.html#a96392c5c7e198251a7efacba03414393">nf</a></div><div class="ttdeci">#define nf</div><div class="ttdoc">Fermion flavours (double it)</div><div class="ttdef"><b>Definition</b> <a href="sizes_8h_source.html#l00151">sizes.h:151</a></div></div>
<div class="ttc" id="asizes_8h_html_a9e9166fe6661b2f5b5ccf94e70ccdf83"><div class="ttname"><a href="sizes_8h.html#a9e9166fe6661b2f5b5ccf94e70ccdf83">ndirac</a></div><div class="ttdeci">#define ndirac</div><div class="ttdoc">Dirac indices.</div><div class="ttdef"><b>Definition</b> <a href="sizes_8h_source.html#l00177">sizes.h:177</a></div></div>
<div class="ttc" id="asizes_8h_html_ac0e106846c6b4f2766406f963e3e9af6"><div class="ttname"><a href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a></div><div class="ttdeci">#define Complex_f</div><div class="ttdoc">Single precision complex number.</div><div class="ttdef"><b>Definition</b> <a href="sizes_8h_source.html#l00056">sizes.h:56</a></div></div>
<div class="ttc" id="asizes_8h_html_ad08795e9e671720e6f0ec6b3407bf933"><div class="ttname"><a href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a></div><div class="ttdeci">#define ndim</div><div class="ttdoc">Dimensions.</div><div class="ttdef"><b>Definition</b> <a href="sizes_8h_source.html#l00179">sizes.h:179</a></div></div>
<div class="ttc" id="asizes_8h_html_ad0a75cc73930f4f3c147efd824764b07"><div class="ttname"><a href="sizes_8h.html#ad0a75cc73930f4f3c147efd824764b07">kferm2</a></div><div class="ttdeci">#define kferm2</div><div class="ttdoc">sublattice size including Dirac indices</div><div class="ttdef"><b>Definition</b> <a href="sizes_8h_source.html#l00188">sizes.h:188</a></div></div>
<div class="ttc" id="asu2hmc_8h_html_a4b97a088fd74bb3b25ce4f965dc26281"><div class="ttname"><a href="su2hmc_8h.html#a4b97a088fd74bb3b25ce4f965dc26281">Congradq</a></div><div class="ttdeci">int Congradq(int na, double res, Complex *X1, Complex *r, Complex_f *ut[2], unsigned int *iu, unsigned int *id, Complex_f *gamval_f, int *gamin, float *dk[2], Complex_f jqq, float akappa, int *itercg)</div><div class="ttdoc">Matrix Inversion via Conjugate Gradient (up/down flavour partitioning). Solves  Implements up/down pa...</div><div class="ttdef"><b>Definition</b> <a href="congrad_8c_source.html#l00007">congrad.c:7</a></div></div>
<div class="ttc" id="asu2hmc_8h_html_ad4816b4c3599a65d212f34e10c83055f"><div class="ttname"><a href="su2hmc_8h.html#ad4816b4c3599a65d212f34e10c83055f">Fill_Small_Phi</a></div><div class="ttdeci">int Fill_Small_Phi(int na, Complex *smallPhi, Complex *Phi)</div><div class="ttdef"><b>Definition</b> <a href="su2hmc_8c_source.html#l00385">su2hmc.c:385</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="sizes_8h_source.html#l00268">AVX</a>, <a class="el" href="sizes_8h_source.html#l00058">Complex</a>, <a class="el" href="sizes_8h_source.html#l00056">Complex_f</a>, <a class="el" href="congrad_8c_source.html#l00007">Congradq()</a>, <a class="el" href="par__mpi_8h_source.html#l00035">DOWN</a>, <a class="el" href="su2hmc_8c_source.html#l00385">Fill_Small_Phi()</a>, <a class="el" href="force_8c_source.html#l00006">Gauge_force()</a>, <a class="el" href="matrices_8c_source.html#l00268">Hdslash()</a>, <a class="el" href="matrices_8c_source.html#l00712">Hdslash_f()</a>, <a class="el" href="sizes_8h_source.html#l00188">kferm2</a>, <a class="el" href="sizes_8h_source.html#l00227">kferm2Halo</a>, <a class="el" href="sizes_8h_source.html#l00154">kvol</a>, <a class="el" href="sizes_8h_source.html#l00175">nadj</a>, <a class="el" href="sizes_8h_source.html#l00173">nc</a>, <a class="el" href="sizes_8h_source.html#l00179">ndim</a>, <a class="el" href="sizes_8h_source.html#l00177">ndirac</a>, <a class="el" href="sizes_8h_source.html#l00151">nf</a>, and <a class="el" href="par__mpi_8h.html#a893a7c85fb77e355d4cec6bc35711b98">ZHalo_swap_dir()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="force_8c_a98a5926c20124e0cea060ad1e47ff3de_cgraph.svg" width="556" height="332"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="force_8c_a98a5926c20124e0cea060ad1e47ff3de_icgraph.svg" width="283" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab8975ff11cde008308f4d18a8f25425e" name="ab8975ff11cde008308f4d18a8f25425e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8975ff11cde008308f4d18a8f25425e">&#9670;&#160;</a></span>Gauge_force()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Gauge_force </td>
          <td>(</td>
          <td class="paramtype">double *</td>          <td class="paramname"><span class="paramname"><em>dSdpi</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a> *</td>          <td class="paramname"><span class="paramname"><em>ut</em></span>[2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>iu</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *</td>          <td class="paramname"><span class="paramname"><em>id</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float</td>          <td class="paramname"><span class="paramname"><em>beta</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the gauge force due to the Wilson Action at each intermediate time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dSdpi</td><td>The force </td></tr>
    <tr><td class="paramname">ut</td><td>Gauge fields </td></tr>
    <tr><td class="paramname">iu,id</td><td>Lattice indices </td></tr>
    <tr><td class="paramname">beta</td><td>Inverse gauge coupling</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero on success, integer error code otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="force_8c_source.html#l00006">6</a> of file <a class="el" href="force_8c_source.html">force.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">    6</span>                                                                                              {</div>
<div class="line"><span class="lineno">    7</span>   <span class="comment">/*</span></div>
<div class="line"><span class="lineno">    8</span><span class="comment">    * Calculates dSdpi due to the Wilson Action at each intermediate time</span></div>
<div class="line"><span class="lineno">    9</span><span class="comment">    *</span></div>
<div class="line"><span class="lineno">   10</span><span class="comment">    * Calls:</span></div>
<div class="line"><span class="lineno">   11</span><span class="comment">    * =====</span></div>
<div class="line"><span class="lineno">   12</span><span class="comment">    * C_Halo_swap_all, C_gather, C_Halo_swap_dir</span></div>
<div class="line"><span class="lineno">   13</span><span class="comment">    *</span></div>
<div class="line"><span class="lineno">   14</span><span class="comment">    * Parameters:</span></div>
<div class="line"><span class="lineno">   15</span><span class="comment">    * =======</span></div>
<div class="line"><span class="lineno">   16</span><span class="comment">    * double         *dSdpi</span></div>
<div class="line"><span class="lineno">   17</span><span class="comment">    * Complex_f         *ut[0]</span></div>
<div class="line"><span class="lineno">   18</span><span class="comment">    * Complex_f         *ut[1]</span></div>
<div class="line"><span class="lineno">   19</span><span class="comment">    * unsigned int   *iu </span></div>
<div class="line"><span class="lineno">   20</span><span class="comment">    * unsigned int   *id </span></div>
<div class="line"><span class="lineno">   21</span><span class="comment">    * float          beta</span></div>
<div class="line"><span class="lineno">   22</span><span class="comment">    *</span></div>
<div class="line"><span class="lineno">   23</span><span class="comment">    * Returns:</span></div>
<div class="line"><span class="lineno">   24</span><span class="comment">    * =======</span></div>
<div class="line"><span class="lineno">   25</span><span class="comment">    * Zero on success, integer error code otherwise</span></div>
<div class="line"><span class="lineno">   26</span><span class="comment">    */</span></div>
<div class="line"><span class="lineno">   27</span>   <span class="keyword">const</span> <span class="keywordtype">char</span> *funcname = <span class="stringliteral">&quot;Gauge_force&quot;</span>;</div>
<div class="line"><span class="lineno">   28</span> </div>
<div class="line"><span class="lineno">   29</span>   <span class="comment">//We define zero halos for debugging</span></div>
<div class="line"><span class="lineno">   30</span>   <span class="comment">// #ifdef _DEBUG</span></div>
<div class="line"><span class="lineno">   31</span>   <span class="comment">//    memset(ut[0][kvol], 0, ndim*halo*sizeof(Complex_f));  </span></div>
<div class="line"><span class="lineno">   32</span>   <span class="comment">//    memset(ut[1][kvol], 0, ndim*halo*sizeof(Complex_f));  </span></div>
<div class="line"><span class="lineno">   33</span>   <span class="comment">// #endif</span></div>
<div class="line"><span class="lineno">   34</span>   <span class="comment">//Was a trial field halo exchange here at one point.</span></div>
<div class="line"><span class="lineno">   35</span><span class="preprocessor">#ifdef __NVCC__</span></div>
<div class="line"><span class="lineno">   36</span>   cuGauge_force(ut,dSdpi,beta,iu,<span class="keywordtype">id</span>,dimGrid,dimBlock);</div>
<div class="line"><span class="lineno">   37</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">   38</span>   <a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a> *Sigma[2], *ush[2];</div>
<div class="line"><span class="lineno">   39</span>   Sigma[0] = (<a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a> *)aligned_alloc(<a class="code hl_define" href="sizes_8h.html#a0235e95ffa2570e0d229e23f65855719">AVX</a>,<a class="code hl_define" href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a>*<span class="keyword">sizeof</span>(<a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a>)); </div>
<div class="line"><span class="lineno">   40</span>   Sigma[1]= (<a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a> *)aligned_alloc(<a class="code hl_define" href="sizes_8h.html#a0235e95ffa2570e0d229e23f65855719">AVX</a>,<a class="code hl_define" href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a>*<span class="keyword">sizeof</span>(<a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a>)); </div>
<div class="line"><span class="lineno">   41</span>   ush[0] = (<a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a> *)aligned_alloc(<a class="code hl_define" href="sizes_8h.html#a0235e95ffa2570e0d229e23f65855719">AVX</a>,(<a class="code hl_define" href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a>+<a class="code hl_define" href="sizes_8h.html#abe2345c185904513f2178697f721041f">halo</a>)*<span class="keyword">sizeof</span>(<a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a>)); </div>
<div class="line"><span class="lineno">   42</span>   ush[1] = (<a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a> *)aligned_alloc(<a class="code hl_define" href="sizes_8h.html#a0235e95ffa2570e0d229e23f65855719">AVX</a>,(<a class="code hl_define" href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a>+<a class="code hl_define" href="sizes_8h.html#abe2345c185904513f2178697f721041f">halo</a>)*<span class="keyword">sizeof</span>(<a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a>)); </div>
<div class="line"><span class="lineno">   43</span>   <span class="comment">//Holders for directions</span></div>
<div class="line"><span class="lineno">   44</span>   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> mu=0; mu&lt;<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>; mu++){</div>
<div class="line"><span class="lineno">   45</span>      memset(Sigma[0],0, <a class="code hl_define" href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a>*<span class="keyword">sizeof</span>(<a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a>));</div>
<div class="line"><span class="lineno">   46</span>      memset(Sigma[1],0, <a class="code hl_define" href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a>*<span class="keyword">sizeof</span>(<a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a>));</div>
<div class="line"><span class="lineno">   47</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> nu=0; nu&lt;<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>; nu++)</div>
<div class="line"><span class="lineno">   48</span>         <span class="keywordflow">if</span>(nu!=mu){</div>
<div class="line"><span class="lineno">   49</span>            <span class="comment">//The +ν Staple</span></div>
<div class="line"><span class="lineno">   50</span><span class="preprocessor">#pragma omp parallel for simd </span><span class="comment">//aligned(ut[0],ut[1],Sigma[0],Sigma[1],iu:AVX)</span></div>
<div class="line"><span class="lineno">   51</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_define" href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a>;i++){</div>
<div class="line"><span class="lineno">   52</span>               <span class="keywordtype">int</span> uidm = iu[mu+<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>*i];</div>
<div class="line"><span class="lineno">   53</span>               <span class="keywordtype">int</span> uidn = iu[nu+<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>*i];</div>
<div class="line"><span class="lineno">   54</span>               <a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a>   a11=ut[0][uidm*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+nu]*conj(ut[0][uidn*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])+\</div>
<div class="line"><span class="lineno">   55</span>                               ut[1][uidm*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+nu]*conj(ut[1][uidn*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]);</div>
<div class="line"><span class="lineno">   56</span>               <a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a>   a12=-ut[0][uidm*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+nu]*ut[1][uidn*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]+\</div>
<div class="line"><span class="lineno">   57</span>                               ut[1][uidm*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+nu]*ut[0][uidn*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu];</div>
<div class="line"><span class="lineno">   58</span>               Sigma[0][i]+=a11*conj(ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+nu])+a12*conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+nu]);</div>
<div class="line"><span class="lineno">   59</span>               Sigma[1][i]+=-a11*ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+nu]+a12*ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+nu];</div>
<div class="line"><span class="lineno">   60</span>            }</div>
<div class="line"><span class="lineno">   61</span>            <a class="code hl_function" href="su2hmc_8h.html#af64f1450e29df479f82290bc4f7bdc1f">C_gather</a>(ush[0], ut[0], <a class="code hl_define" href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a>, <span class="keywordtype">id</span>, nu);</div>
<div class="line"><span class="lineno">   62</span>            <a class="code hl_function" href="su2hmc_8h.html#af64f1450e29df479f82290bc4f7bdc1f">C_gather</a>(ush[1], ut[1], <a class="code hl_define" href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a>, <span class="keywordtype">id</span>, nu);</div>
<div class="line"><span class="lineno">   63</span><span class="preprocessor">#if(nproc&gt;1)</span></div>
<div class="line"><span class="lineno">   64</span>            <a class="code hl_function" href="par__mpi_8h.html#ab73329ce6f65730ba4783a8031edd518">CHalo_swap_dir</a>(ush[0], 1, mu, <a class="code hl_define" href="par__mpi_8h.html#a4193cd1c8c2e6ebd0e056fa2364a663f">DOWN</a>); <a class="code hl_function" href="par__mpi_8h.html#ab73329ce6f65730ba4783a8031edd518">CHalo_swap_dir</a>(ush[1], 1, mu, <a class="code hl_define" href="par__mpi_8h.html#a4193cd1c8c2e6ebd0e056fa2364a663f">DOWN</a>);</div>
<div class="line"><span class="lineno">   65</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   66</span>            <span class="comment">//Next up, the -ν staple</span></div>
<div class="line"><span class="lineno">   67</span><span class="preprocessor">#pragma omp parallel for simd </span><span class="comment">//aligned(ut[0],ut[1],ush[0],ush[1],Sigma[0],Sigma[1],iu,id:AVX)</span></div>
<div class="line"><span class="lineno">   68</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_define" href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a>;i++){</div>
<div class="line"><span class="lineno">   69</span>               <span class="keywordtype">int</span> uidm = iu[mu+<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>*i];</div>
<div class="line"><span class="lineno">   70</span>               <span class="keywordtype">int</span> didn = <span class="keywordtype">id</span>[nu+<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>*i];</div>
<div class="line"><span class="lineno">   71</span>               <span class="comment">//uidm is correct here</span></div>
<div class="line"><span class="lineno">   72</span>               <a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a> a11=conj(ush[0][uidm])*conj(ut[0][didn*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])-\</div>
<div class="line"><span class="lineno">   73</span>                             ush[1][uidm]*conj(ut[1][didn*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]);</div>
<div class="line"><span class="lineno">   74</span>               <a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a> a12=-conj(ush[0][uidm])*ut[1][didn*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]-\</div>
<div class="line"><span class="lineno">   75</span>                             ush[1][uidm]*ut[0][didn*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu];</div>
<div class="line"><span class="lineno">   76</span>               Sigma[0][i]+=a11*ut[0][didn*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+nu]-a12*conj(ut[1][didn*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+nu]);</div>
<div class="line"><span class="lineno">   77</span>               Sigma[1][i]+=a11*ut[1][didn*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+nu]+a12*conj(ut[0][didn*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+nu]);</div>
<div class="line"><span class="lineno">   78</span>            }</div>
<div class="line"><span class="lineno">   79</span>         }</div>
<div class="line"><span class="lineno">   80</span><span class="preprocessor">#pragma omp parallel for simd </span><span class="comment">//aligned(ut[0],ut[1],Sigma[0],Sigma[1],dSdpi:AVX)</span></div>
<div class="line"><span class="lineno">   81</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_define" href="sizes_8h.html#a5a091d04c7929c6484096936e72def64">kvol</a>;i++){</div>
<div class="line"><span class="lineno">   82</span>         <a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a> a11 = ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]*Sigma[1][i]+ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]*conj(Sigma[0][i]);</div>
<div class="line"><span class="lineno">   83</span>         <a class="code hl_define" href="sizes_8h.html#ac0e106846c6b4f2766406f963e3e9af6">Complex_f</a> a12 = ut[0][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]*Sigma[0][i]+conj(ut[1][i*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu])*Sigma[1][i];</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>         dSdpi[(i*<a class="code hl_define" href="sizes_8h.html#a55cdab879029c36c07fbd9e7e9b109c9">nadj</a>)*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]=(<span class="keywordtype">double</span>)(beta*cimag(a11));</div>
<div class="line"><span class="lineno">   86</span>         dSdpi[(i*<a class="code hl_define" href="sizes_8h.html#a55cdab879029c36c07fbd9e7e9b109c9">nadj</a>+1)*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]=(<span class="keywordtype">double</span>)(beta*creal(a11));</div>
<div class="line"><span class="lineno">   87</span>         dSdpi[(i*<a class="code hl_define" href="sizes_8h.html#a55cdab879029c36c07fbd9e7e9b109c9">nadj</a>+2)*<a class="code hl_define" href="sizes_8h.html#ad08795e9e671720e6f0ec6b3407bf933">ndim</a>+mu]=(<span class="keywordtype">double</span>)(beta*cimag(a12));</div>
<div class="line"><span class="lineno">   88</span>      }</div>
<div class="line"><span class="lineno">   89</span>   }</div>
<div class="line"><span class="lineno">   90</span>   free(ush[0]); free(ush[1]); free(Sigma[0]); free(Sigma[1]);</div>
<div class="line"><span class="lineno">   91</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   92</span>   <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   93</span>}</div>
<div class="ttc" id="apar__mpi_8h_html_ab73329ce6f65730ba4783a8031edd518"><div class="ttname"><a href="par__mpi_8h.html#ab73329ce6f65730ba4783a8031edd518">CHalo_swap_dir</a></div><div class="ttdeci">int CHalo_swap_dir(Complex_f *c, int ncpt, int idir, int layer)</div><div class="ttdoc">Swaps the halos along the axis given by idir in the direction given by layer.</div></div>
<div class="ttc" id="asizes_8h_html_abe2345c185904513f2178697f721041f"><div class="ttname"><a href="sizes_8h.html#abe2345c185904513f2178697f721041f">halo</a></div><div class="ttdeci">#define halo</div><div class="ttdoc">Total Halo size.</div><div class="ttdef"><b>Definition</b> <a href="sizes_8h_source.html#l00222">sizes.h:222</a></div></div>
<div class="ttc" id="asu2hmc_8h_html_af64f1450e29df479f82290bc4f7bdc1f"><div class="ttname"><a href="su2hmc_8h.html#af64f1450e29df479f82290bc4f7bdc1f">C_gather</a></div><div class="ttdeci">int C_gather(Complex_f *x, Complex_f *y, int n, unsigned int *table, unsigned int mu)</div><div class="ttdoc">Extracts all the single precision gauge links in the  direction only.</div><div class="ttdef"><b>Definition</b> <a href="su2hmc_8c_source.html#l00357">su2hmc.c:357</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="sizes_8h_source.html#l00268">AVX</a>, <a class="el" href="su2hmc_8c_source.html#l00357">C_gather()</a>, <a class="el" href="par__mpi_8h.html#ab73329ce6f65730ba4783a8031edd518">CHalo_swap_dir()</a>, <a class="el" href="sizes_8h_source.html#l00056">Complex_f</a>, <a class="el" href="par__mpi_8h_source.html#l00035">DOWN</a>, <a class="el" href="sizes_8h_source.html#l00222">halo</a>, <a class="el" href="sizes_8h_source.html#l00154">kvol</a>, <a class="el" href="sizes_8h_source.html#l00175">nadj</a>, and <a class="el" href="sizes_8h_source.html#l00179">ndim</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="force_8c_ab8975ff11cde008308f4d18a8f25425e_cgraph.svg" width="271" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="force_8c_ab8975ff11cde008308f4d18a8f25425e_icgraph.svg" width="427" height="135"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_c2115e3ea85988db908c8a00abe14206.html">production_c</a></li><li class="navelem"><a class="el" href="force_8c.html">force.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
