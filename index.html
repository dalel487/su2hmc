<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>su2hmc: su2hmc</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">su2hmc
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('index.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">su2hmc </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a></p>
<p><a href="https://doi.org/10.5281/zenodo.7164406"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.7164406.svg" alt="DOI" style="pointer-events: none;" class="inline"/></a> </p>
<h1><a class="anchor" id="autotoc_md4"></a>
su2hmc: Two Colour Hybrid Monte Carlo with Wilson Fermions</h1>
<h2><a class="anchor" id="autotoc_md5"></a>
Introduction</h2>
<p>Hybrid Monte Carlo algorithm for Two Color QCD with Wilson-Gor'kov fermions based on the algorithm of Duane et al. Phys. Lett. B195 (1987) 216.</p>
<p>There is "up/down partitioning": each update requires one operation of congradq on complex vectors to determine $$ \left(M^\dagger M\right)^{-1}\Phi $$ where $\Phi$ has dimension 4 * kvol * nc * Nf - The matrix M is the Wilson matrix for a single flavor there is no extra species doubling as a result</p>
<p>matrix multiplies done using routines <code>hdslash</code> and <code>hdslashd</code></p>
<p>Hence, the number of lattice flavors Nf is related to the number of continuum flavors N_f by $$N_f = 2 \text{Nf}$$</p>
<p>Fermion expectation values are measured using a noisy estimator. on the Wilson-Gor'kov matrix, which has dimension 8 * kvol * nc * Nf inversions done using <code>congradp</code>, and matrix multiplies with <code>dslash</code>, <code>dslashd</code></p>
<p>trajectory length is random with mean dt * stepl The code runs for a fixed number ntraj of trajectories.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"></th><th class="markdownTableHeadRight"></th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Phi   </td><td class="markdownTableBodyRight">pseudofermion field    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">bmass   </td><td class="markdownTableBodyRight">bare fermion mass    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">fmu   </td><td class="markdownTableBodyRight">chemical potential    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">actiona   </td><td class="markdownTableBodyRight">running average of total action   </td></tr>
</table>
<p>Fermion expectation values are measured using a noisy estimator. The code produces the following outputs: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">File Name   </th><th class="markdownTableHeadLeft">Data type    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">config.bβββkκκκmuμμμμjJJJsNXtNT.XXXXXX   </td><td class="markdownTableBodyLeft">Lattice configuration for given parameters. Last digits are the configuration number    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Output.bβββkκκκmuμμμμjJJJsNXtNT   </td><td class="markdownTableBodyLeft">Number of conjugate gradient steps for each trajectory. Also contains general simulation details upon completion    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">bose.bβββkκκκmuμμμμjJJJsNXtNT   </td><td class="markdownTableBodyLeft">spatial plaquette, temporal plaquette, Polyakov line    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">fermi.bβββkκκκmuμμμμjJJJsNXtNT   </td><td class="markdownTableBodyLeft">psibarpsi, energy density, baryon density    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">diq.bβββkκκκmuμμμμjJJJsNXtNT   </td><td class="markdownTableBodyLeft">real&lt;qq&gt;   </td></tr>
</table>
<p>SJH March 2005</p>
<p>Hybrid code, P.Giudice, May 2013</p>
<p>Converted from Fortran to C by D. Lawlor March 2021</p>
<h3><a class="anchor" id="autotoc_md6"></a>
Conversion notes</h3>
<p>This two colour implementation was originally written in FORTRAN for: [S. Hands, S. Kim and J.-I. Skullerud, Deconfinement in dense 2-color QCD, Eur. Phys. J. C48, 193 (2006), hep- lat/0604004](<a href="https://arxiv.org/abs/hep-lat/0604004">https://arxiv.org/abs/hep-lat/0604004</a>)</p>
<p>It has since been rewritten in C and is in the process of being adapted for CUDA. We have sucessfully run on 7000+ Zen 2 cores, as well as A100 GPUs</p>
<p>Some adaptions from the original are:</p><ul>
<li>Mixed precision conjugate gradient</li>
<li>Implementation of BLAS routines for vector operations</li>
<li>Removal of excess halo exchanges</li>
<li><code>#pragma omp simd</code> instructions</li>
<li>Makefiles for Intel, GCC and AMD compilers with flags set for latest machines</li>
<li>GSL ranlux support</li>
<li>CUDA implementation.</li>
</ul>
<p>Other works in progress include:</p><ul>
<li>Improved action</li>
<li>SYCL implementation.</li>
<li>Multi-GPU support</li>
<li>CMake build system</li>
<li>yaml input file</li>
<li>Set lattice volume and CPU grid at runtime</li>
<li>Higher order integrators. 11 stage 4th order non-gradient integrator implimented but no speedup yet</li>
</ul>
<h2><a class="anchor" id="autotoc_md7"></a>
Getting started</h2>
<p>This code is written for MPI on Linux, thus has a few caveats to get up and running</p><ol type="1">
<li>In <a class="el" href="sizes_8h.html" title="Defines the constants of the code and other parameters for loop dimensions. Each subroutine includes ...">sizes.h</a>, set the lattice size. By default we assume the spatial components to be equal</li>
<li>Also in <a class="el" href="sizes_8h.html" title="Defines the constants of the code and other parameters for loop dimensions. Each subroutine includes ...">sizes.h</a> set the processor grid size by setting the values of <div class="fragment"><div class="line">c</div>
<div class="line">  npx npy npz npt</div>
</div><!-- fragment --> These <b>MUST</b> be divisors of <div class="fragment"><div class="line">c</div>
<div class="line">  nx ny nz nt</div>
</div><!-- fragment --> set in step one.</li>
<li>Compile the code using the desired Makefile. Please note that the paths given in the Makefiles for BLAS libraries etc. are based on my own system. You may need to adjust these manually.</li>
<li><p class="startli">Run the code. This may differ from system to system, especially if a task scheduler like SLURM is being used. On my desktop it can be run locally using the following command</p>
<div class="fragment"><div class="line">sh</div>
<div class="line">  mpirun -n&lt;nproc&gt; ./su2hmc &lt;input_file&gt;</div>
</div><!-- fragment --></li>
</ol>
<ul>
<li><code>nproc</code> is the number of processors, given by the product of <code>npx npy npz npt</code></li>
<li>If no input file is given, the programme defaults to midout. The default name is a historical one which goes back generations to the early days of Lattice QCD.</li>
</ul>
<h3><a class="anchor" id="autotoc_md8"></a>
Input parameters</h3>
<p>A sample input file looks like </p><div class="fragment"><div class="line">0.00200  1.7   0.1780   0.00  0.000 0.0   0.0   500   20 1  1  100</div>
<div class="line">dt beta  akappa   jqq   thetaq   fmu   aNf   stepl ntraj istart   icheck   iread</div>
</div><!-- fragment --><p> where</p><ul>
<li><code>dt</code> is the step size for the update</li>
<li><code>beta</code> is β, given up to three significant figures</li>
<li><code>akappa</code> is hopping parameter, given up to four significant figures</li>
<li><code>jqq</code> is the diquark source, given up to three significant figures</li>
<li><code>thetaq</code> is the diquark mixing angle</li>
<li><code>fmu</code> is the chemical potential</li>
<li><code>aNf</code> is ignored. Originating in the Cornell group when Ken Wilson was still there, that molecular dynamics time-discretisation artifacts can be absorbed into renormalisation of the bare parameters of the lattice action</li>
<li><code>stepl</code> is the average number of steps per trajectory. For a single trajectory it times dt should equal 1</li>
<li><code>ntraj</code> is the number of trajectories</li>
<li><code>istart</code> signals a hot start (&gt;=1) or cold start (&lt;=0)</li>
<li><code>icheck</code> is how often to print out a configuration. We typically use 5 and tune for 80% acceptance rate</li>
<li><code>iread</code> is the starting configuration for continuation runs. If zero, start without reading</li>
</ul>
<p>The bottom line of the input is ignored by the programme and is just there to make your life easier. Blank space does not matter, so long as there is some gap between the input parameters in the file and they are all on a single line. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
